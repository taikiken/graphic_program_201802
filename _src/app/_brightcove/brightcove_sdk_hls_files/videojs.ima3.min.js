/*! videojs-ima3 - v1.15.3 - 2016-02-16
 * Copyright (c) 2016 Brightcove  */
!function(a,b,c,d){"use strict";var e=function(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a},f=function(a,b,c){var d,e,f=Object.prototype.toString.call(b),g=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c);else if(a.on)a.on(b,c);else{if(!a.attachEvent)throw new Error("object has no mechanism for adding event listeners");a.attachEvent("on"+b,c)}};switch(f){case"[object String]":g(a,b,c);break;case"[object Array]":for(d=0,e=b.length;e>d;d++)g(a,b[d],c);break;case"[object Object]":for(d in b)b.hasOwnProperty(d)&&g(a,d,b[d]);break;default:throw new Error("Unrecognized events parameter type: "+f)}return a},g=function(b){return(a.setImmediate||a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.setTimeout)(b,0)},h=function(b){return(a.clearImmediate||a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.clearTimeout)(b)},i=function(a){a.ads.cancelPlayTimeout||(a.ads.cancelPlayTimeout=g(function(){a.ads.cancelPlayTimeout=null,a.paused()||a.pause(),a.one("contentplayback",function(){a.paused()&&a.play()})}))},j=function(a){var b,c,d=a.el().querySelector(".vjs-tech"),e=a.remoteTextTracks?a.remoteTextTracks():[],f=[],g={ended:a.ended(),currentSrc:a.currentSrc(),src:a.src(),currentTime:a.currentTime(),type:a.currentType()};for(d&&(g.nativePoster=d.poster,g.style=d.getAttribute("style")),c=e.length;c--;)b=e[c],f.push({track:b,mode:b.mode}),b.mode="disabled";return g.suppressedTracks=f,g},k=function(a,b){for(var c=a.className.split(/\s+/),d=c.length,e=[];d--;)c[d]!==b&&e.push(c[d]);a.className=e.join(" ")},l=function(b,c){var e,f,g=b.el().querySelector(".vjs-tech"),h=20,i=c.suppressedTracks,j=function(){for(var a=i.length;a--;)e=i[a],e.track.mode=e.mode},k=function(){var d=!1,e=function(){d=!0};b.currentTime(c.currentTime),c.ended?(a.setTimeout(function(){d||b.play(),b.off("ended",e)},250),b.on("ended",e)):b.play()},l=function(){return g.readyState>1?k():g.seekable===d?k():g.seekable.length>0?k():void(h--?setTimeout(l,50):!function(){try{k()}catch(a){videojs.log.warn("Failed to resume the content after an advertisement",a)}}())};c.nativePoster&&(g.poster=c.nativePoster),"style"in c&&g.setAttribute("style",c.style||""),f=b.src()!==c.src||b.currentSrc()!==c.currentSrc,f?(b.one("contentloadedmetadata",j),b.src({src:c.currentSrc,type:c.type}),b.load(),b.one("contentcanplay",l)):b.ended()&&c.ended||(j(),b.play())},m=function(a){var b=a.el().querySelector(".vjs-tech");b&&b.removeAttribute("poster")},n={timeout:5e3,prerollTimeout:100,postrollTimeout:100,debug:!1},o=function(b){var d,o=this,p=e({},n,b||{});!function(){var a,b=videojs.Html5.Events,c=function(){return!0},d=function(a,b){b.isImmediatePropagationStopped=c,b.cancelBubble=!0,b.isPropagationStopped=c,o.trigger({type:a+b.type,state:o.ads.state,originalEvent:b})},e=function(a){if("ad-playback"===o.ads.state)d("ad",a);else if("content-playback"===o.ads.state&&"ended"===a.type)d("content",a);else if("content-resuming"===o.ads.state){if(o.ads.snapshot){if(o.currentSrc()!==o.ads.snapshot.currentSrc){if("loadstart"===a.type)return;return d("content",a)}if(o.ads.snapshot.ended)return"pause"===a.type||"ended"===a.type?void o.addClass("vjs-has-started"):d("content",a)}"playing"!==a.type&&d("content",a)}};for(b.push("firstplay"),b.push("loadedalldata"),a=b.length;a--;)o.on(b[a],e);return e}(),o.on(["addurationchange","adcanplay"],function(){var a=o.ads.snapshot;o.currentSrc()!==a.currentSrc&&o.play()}),o.ads={state:"content-set",startLinearAdMode:function(){"ad-playback"!==o.ads.state&&o.trigger("adstart")},endLinearAdMode:function(){"ad-playback"===o.ads.state&&o.trigger("adend")},skipLinearAdMode:function(){"ad-playback"!==o.ads.state&&o.trigger("adskip")}},d=function(b){var c={"content-set":{events:{adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="ads-ready"},play:function(){this.state="ads-ready?",i(o),m(o)},adserror:function(){this.state="content-playback"},adskip:function(){this.state="content-playback"}}},"ads-ready":{events:{play:function(){this.state="preroll?",i(o)},adskip:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"preroll?":{enter:function(){o.el().className+=" vjs-ad-loading",o.ads.timeout=a.setTimeout(function(){o.trigger("adtimeout")},p.prerollTimeout),o.trigger("readyforpreroll")},leave:function(){a.clearTimeout(o.ads.timeout),k(o.el(),"vjs-ad-loading")},events:{play:function(){i(o)},adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ads-ready?":{enter:function(){o.el().className+=" vjs-ad-loading",o.ads.timeout=a.setTimeout(function(){o.trigger("adtimeout")},p.timeout)},leave:function(){a.clearTimeout(o.ads.timeout),k(o.el(),"vjs-ad-loading")},events:{play:function(){i(o)},adscanceled:function(){this.state="content-playback"},adsready:function(){this.state="preroll?"},adskip:function(){this.state="content-playback"},adtimeout:function(){this.state="content-playback"},adserror:function(){this.state="content-playback"}}},"ad-playback":{enter:function(){this.snapshot=j(o),o.el().className+=" vjs-ad-playing",m(o),o.ads.cancelPlayTimeout&&(h(o.ads.cancelPlayTimeout),o.ads.cancelPlayTimeout=null)},leave:function(){k(o.el(),"vjs-ad-playing"),l(o,this.snapshot),"adend"!==o.ads.triggerevent&&o.trigger("adend")},events:{adend:function(){this.state="content-resuming"},adserror:function(){this.state="content-resuming"}}},"content-resuming":{enter:function(){this.snapshot.ended&&(a.clearTimeout(o.ads._fireEndedTimeout),o.ads._fireEndedTimeout=a.setTimeout(function(){o.trigger("ended")},1e3))},leave:function(){a.clearTimeout(o.ads._fireEndedTimeout)},events:{contentupdate:function(){this.state="content-set"},playing:function(){this.state="content-playback"},ended:function(){this.state="content-playback"}}},"postroll?":{enter:function(){this.snapshot=j(o),o.el().className+=" vjs-ad-loading",o.ads.timeout=a.setTimeout(function(){o.trigger("adtimeout")},p.postrollTimeout)},leave:function(){a.clearTimeout(o.ads.timeout),k(o.el(),"vjs-ad-loading")},events:{adstart:function(){this.state="ad-playback"},adskip:function(){this.state="content-resuming",g(function(){o.trigger("ended")})},adtimeout:function(){this.state="content-resuming",g(function(){o.trigger("ended")})},adserror:function(){this.state="content-resuming",g(function(){o.trigger("ended")})}}},"content-playback":{enter:function(){o.ads.cancelPlayTimeout&&(h(o.ads.cancelPlayTimeout),o.ads.cancelPlayTimeout=null),o.trigger({type:"contentplayback",triggerevent:o.ads.triggerevent})},events:{adsready:function(){o.trigger("readyforpreroll")},adstart:function(){this.state="ad-playback"},contentupdate:function(){o.paused()?this.state="content-set":this.state="ads-ready?"},contentended:function(){this.state="postroll?"}}}};!function(a){var d=function(){};((c[a].events||{})[b.type]||d).apply(o.ads),a!==o.ads.state&&(o.ads.triggerevent=b.type,(c[a].leave||d).apply(o.ads),(c[o.ads.state].enter||d).apply(o.ads),p.debug&&videojs.log("ads",o.ads.triggerevent+" triggered: "+a+" -> "+o.ads.state))}(o.ads.state)},f(o,c.Html5.Events.concat(["adtimeout","contentupdate","contentplaying","contentended","adsready","adserror","adscanceled","adstart","adend","adskip"]),d),o.ads.contentSrc=o.currentSrc(),function(){var a=function(){var a;"ad-playback"!==o.ads.state&&(a=o.currentSrc(),a!==o.ads.contentSrc&&(o.trigger({type:"contentupdate",oldValue:o.ads.contentSrc,newValue:a}),o.ads.contentSrc=a))};o.on(["loadstart"],a),g(a)}(),o.paused()||d({type:"play"})};c.plugin("ads",o)}(window,document,videojs),function(a,b,c,d){var e=c.ima3={},f=e.defaults={sdkurl:(/^(file|data):/.test(location.protocol)?"http:":"")+"//s0.2mdn.net/instream/html5/ima3.js",adTechOrder:["flash","html5"],serverUrl:("file:"===location.protocol?"http:":"")+"//pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062%2Fiab_vast_samples&ciu_szs=300x250%2C728x90&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]&cust_params=iab_vast_samples%3Dlinear",adSwf:("file:"===location.protocol?"http:":"")+"//players.brightcove.net/videojs-ima3/videojs.ima3.swf",loadingSpinner:!1,timeout:5e3,prerollTimeout:1e3,requestMode:"onload"},g=function(e){var g,i,j=h({},f,e||{}),k=this,l=k.el().querySelector(".vjs-tech"),m=j.adTechOrder,n=!1;"adControlBar"in j||(j.adControlBar=h(k.options().children.controlBar,{name:"adControlBar"})),k.ads(j),k.on("ima3-ready",function(){var a;for(k.ima3.isReady_=!0,a=0;a<k.ima3.readyQueue_.length;a++)k.ima3.readyQueue_[a].call(this);k.ima3.readyQueue_=[]}),k.ima3={readyQueue_:[],isReady_:!1,player:k,tech:l,settings:j,ready:function(a){return a&&(k.ima3.isReady_?a.call(this):(k.ima3.readyQueue_===d&&(k.ima3.readyQueue_=[]),k.ima3.readyQueue_.push(a))),k.ima3},makeAdRequestFunction:function(a){return function(b){var d=b||this.settings.serverUrl;return d?(c.log("Clearing any previous VAST ad data and triggering ondemand adrequest."),void a.call(k,d)):void c.log("On demand adRequest attempted without an adTagUrl!")}},adMacroReplacement:function(c){var d={"{player.id}":k.id(),"{mediainfo.id}":"","{mediainfo.name}":"","{mediainfo.description}":"","{mediainfo.tags}":"","{mediainfo.reference_id}":"","{mediainfo.duration}":"","{player.duration}":k.duration(),"{timestamp}":(new Date).getTime(),"{document.referrer}":b.referrer,"{window.location.href}":a.location.href,"{random}":Math.floor(1e12*Math.random())};k.mediainfo&&(d["{mediainfo.id}"]=k.mediainfo.id,d["{mediainfo.name}"]=k.mediainfo.name,d["{mediainfo.description}"]=k.mediainfo.description,d["{mediainfo.tags}"]=k.mediainfo.tags,d["{mediainfo.reference_id}"]=k.mediainfo.reference_id,d["{mediainfo.duration}"]=k.mediainfo.duration),k.bcAnalytics&&(d["{player.url}"]=a.location.protocol+"//"+k.bcAnalytics.settings.player);for(var e in d)c=c.split(e).join(encodeURIComponent(d[e]));return c},version:"1.15.3"},k.on("adplay",function(){var a=k.src()!==k.ads.snapshot.src||k.currentSrc()!==k.ads.snapshot.currentSrc;a||setTimeout(function(){k.pause()},0)});for(g in m)if(i=m[g].charAt(0).toUpperCase()+m[g].substring(1).toLowerCase(),c[i].isSupported()){c.ima3[i].call(k,j),k.addClass("vjs-ima3-"+i.toLowerCase()),j.loadingSpinner&&k.addClass("ima3-loading-spinner"),n=!0;break}return n?void 0:void c.log("No supported ad tech available. If you have removed one of the default ad techs, you may want to consider adding it back in.")},h=c.ima3.extend=function(a){var b,c,d;for(c=1;c<arguments.length;c++){b=arguments[c];for(d in b)b.hasOwnProperty(d)&&(a[d]=b[d])}return a};c.ima3.AdPlayer=videojs.Component.extend({buffered:function(){return[]},init:function(a,b,d){c.Component.call(this,this,b,d)},language:function(){},languages:function(){},Va:function(){},localize:function(){},muted:function(a){return a!==d?0===this.volume(a?0:1):0===this.volume()},remainingTime:function(){return this.duration()-this.currentTime()},exitFullscreen:function(){return this.options().contentPlayer.exitFullscreen()},reportUserActivity:function(){},requestFullscreen:function(){return this.options().contentPlayer.requestFullscreen()},textTracks:function(){},remoteTextTracks:function(){},addTextTrack:function(){},addRemoteTextTrack:function(){},removeRemoteTextTrack:function(){}}),c.plugin("ima3",g)}(window,document,videojs),function(a,b,c,d){var e=c.ima3.extend,f=c.ima3.Html5=function(d){var f,j,k,l,m,n,o,p,q,r,s=this,t=s.el().querySelector(".vjs-tech"),u=b.createElement("div"),v=function(){s.ima3&&s.ima3.adsManager&&s.ima3.adsManager.skip&&s.ima3.adsManager.skip(),o()};u.className="vjs-ima3-ad-container",t.parentNode.insertBefore(u,t.nextSibling),r=function(a){s.ads.startLinearAdMode(),o(),m(d,a),s.addClass("ima3-ad-loading")},c.ima3.Html5.adrequest=function(){return c.log.warn("videojs.ima3.Html5.adrequest is deprecated. Use player.ima3.adrequest instead."),r.apply(this,arguments)},s.ima3.adrequest=s.ima3.makeAdRequestFunction(r),s.on("ima3-content-pause-requested",function(a){s.ads.startLinearAdMode(),s.addClass("ima3-ad-loading")}),s.on("ima3-content-resume-requested",function(a){s.ads.endLinearAdMode(),s.removeClass("ima3-ad-loading")}),s.on("fullscreenchange",function(a){var b,c=" "+s.el().className+" ",d=c.indexOf(" vjs-fullscreen ")>-1,e=3,f=function(a,c){return function(){b===p.ViewMode.FULLSCREEN?s.ima3.adsManager.resize(s.el().offsetWidth,s.el().offsetHeight,b):s.ima3.adsManager.resize(s.width(),s.height(),b),(s.width()!==a||s.height()!==c)&&e--&&setTimeout(f(s.width(),s.height()),1e3)}};s.ima3&&s.ima3.adsManager&&(b=d?p.ViewMode.FULLSCREEN:p.ViewMode.NORMAL,b===p.ViewMode.FULLSCREEN?s.ima3.adsManager.resize(s.el().offsetWidth,s.el().offsetHeight,b):s.ima3.adsManager.resize(s.width(),s.height(),b),setTimeout(f(s.width(),s.height()),1e3))}),s.on("ima3-started",function(){s.removeClass("ima3-ad-loading"),c.log("ima3-started")}),s.on("ima3-ad-error",function(a){a.originalEvent&&c.log("ima3-ad-error",a.originalEvent.getError().toString(),a),s.removeClass("ima3-ad-loading"),s.trigger("adserror")}),s.on("ima3-loaded",function(a){var b=a.originalEvent.getAd();s.ima3.currentAd=b,s.removeClass("ima3-ad-loading"),b&&!b.isLinear()&&s.addClass("vjs-ima3-overlay")}),s.on("ima3-complete",function(a){var b=a.originalEvent.getAd();c.log("ima3-complete"),delete s.ima3.currentAd,b&&(b.isLinear()?s.addClass("ima3-ad-loading"):s.removeClass("vjs-ima3-overlay"))}),s.on("resize",function(){s.ima3.adsManager&&s.ima3.adsManager.resize(s.width(),s.height(),p.ViewMode.NORMAL)}),s.on("readyforpreroll",function(){n()}),s.on("adserror",function(){o()}),s.on("ima3-ads-manager-loaded",function(a){var b,c;s.ima3.managerCleanup&&o(),c={},c.currentTime=s.currentTime(),c.duration=s.duration(),s.on("timeupdate",function(){c.currentTime=s.currentTime()}),b=a.originalEvent.getAdsManager(c),s.ima3.adsManager=b,s.ima3.managerCleanup=i(b,q,s),"ad-playback"===s.ads.state?n():s.trigger("adsready")}),l=function(a,b){return s.ima3.adsRequest=e(new p.AdsRequest,{adTagUrl:s.ima3.adMacroReplacement(b||s.ima3.settings.serverUrl),linearAdSlotWidth:s.width(),linearAdSlotHeight:s.height(),nonLinearAdSlotWidth:s.width(),nonLinearAdSlotHeight:s.height()}),s.ima3.adsRequest.adTagUrl?void 0:void s.trigger("adscanceled")},m=function(a,b){"onplay"===a.requestMode?s.one("play",function(){l(a,b),s.ima3.adsLoader.requestAds(s.ima3.adsRequest)}):(l(a,b),s.ima3.adsLoader.requestAds(s.ima3.adsRequest))},n=function(){try{s.ima3.adsManager.init(s.width(),s.height(),p.ViewMode.NORMAL),s.ima3.adsManager.start()}catch(a){s.trigger("adserror")}},o=function(){s.ima3.adsManager&&(s.ima3.adsManager.destroy(),s.ima3.adsManager=null),s.ima3.managerCleanup&&(s.ima3.managerCleanup(),s.ima3.managerCleanup=null)},k=function(){var b,e,g,k=d.ima3SdkSettings,l=t;if(p=a.google.ima,q=h(p),d.ima3SdkSettings)for(e in d.ima3SdkSettings)g="set"+e.charAt(0).toUpperCase()+e.slice(1),p.ImaSdkSettings[g](k[e]);j=c.ima3.Html5.adPlayer(u,{contentPlayer:s}),f=new c.ControlBar(j,d.adControlBar),f.addClass("vjs-ad-control-bar"),s.addClass("vjs-ad-controls"),s.addChild(f),s.ima3.adControlBar=f,s.ima3.adPlayer=j,s.on("adstart",function(a){s.pause()}),s.ima3.adDisplayContainer=new p.AdDisplayContainer(u,l,d.clickTrackingElement),s.one("touchstart",function(){s.ima3.adDisplayContainer.initialize()}),s.ima3.adsLoader=new p.AdsLoader(s.ima3.adDisplayContainer),b=s.ima3.adsLoader.getSettings(),b.setPlayerVersion(s.ima3.version),b.setPlayerType("brightcove/player-html5"),s.ima3.loaderCleanup=i(s.ima3.adsLoader,q,s),s.currentSrc()&&"ondemand"!==d.requestMode&&m(d),s.on("contentupdate",function(){"ondemand"!==d.requestMode&&m(d)}),s.on("contentended",function(){"postroll?"===s.ads.state&&(s.one("adtimeout",v),s.ima3.adsLoader.contentComplete())}),s.on(["contentupdate","dispose"],function(){s.off("adtimeout",v)}),s.ima3.el=u},a.google&&a.google.ima?(k(),s.trigger("ima3-ready")):g(d.sdkurl,function(a){k(),a?s.trigger({type:"adserror",info:a}):s.trigger("ima3-ready")})},g=function(a,c){var d=b.createElement("script"),e=b.querySelector("head");d.async=!0,d.src=a,d.onload=d.onreadystatechange=function(a,b){(b||!d.readyState||/loaded|complete/.test(d.readyState))&&(d.onload=d.onreadystatechange=null,d.parentNode.removeChild(d),d=null,c(b))},e.insertBefore(d,e.firstChild)},h=f.eventTypes=function(a){for(var b,c,d={},e=function(a){return"ima3-"+a.toLowerCase().replace(/_/g,"-")},f=["AdErrorEvent","AdEvent","AdsManagerLoadedEvent"],g=f.length;g--;)if(a[f[g]]&&a[f[g]].Type){b=a[f[g]].Type;for(c in b)b.hasOwnProperty(c)&&(d[b[c]]=[b[c],e(c)])}return d},i=function(a,b,c){var d,e={},f=function(b,d){var f=function(b){c.trigger({type:d,emitter:a,originalEvent:b})};e[b]=f,a.addEventListener(b,f,!1)};for(d in b)f(b[d][0],b[d][1]);return function(){var b;for(b in e)a.removeEventListener(b,e[b])}};c.ima3.Html5.adPlayer=function(b,e){var f=new c.ima3.AdPlayer(b,e),g=e.contentPlayer,h=!0,i=1,j=function(){f.paused()||f.trigger("timeupdate"),a.setTimeout(j,250)};return f.currentTime=function(){var a,b=f.duration();return b?(a=g.ima3.adsManager.getRemainingTime(),0>=a?0:a>b?0:a>0?b-a:void 0):0},f.duration=function(){var a,b=g.ima3.currentAd;return b?(a=b.getDuration(),a>0?a:0):0},f.pause=function(){h=!0,g.ima3.adsManager.pause()},f.paused=function(){return h},f.play=function(){h=!1,g.ima3.adsManager.resume(),f.trigger("play")},f.isFullscreen=function(){return g.isFullscreen()},f.requestFullscreen=function(){return g.requestFullscreen()},f.volume=function(a){return a!==d&&(g.ima3.adsManager.setVolume(a),i=a,f.trigger("volumechange")),i},g.on("ima3-started",function(){g.removeClass("vjs-ima3-paused"),f.trigger("play"),h=!1}),g.on("ima3-resumed",function(){g.removeClass("vjs-ima3-paused"),f.trigger("play"),h=!1}),g.on("ima3-paused",function(){g.addClass("vjs-ima3-paused"),f.trigger("pause"),h=!0}),j(),f}}(window,document,window.videojs),function(a,b,c){var d=function(a,b){for(var c=a,d=b.split("."),e=0;e<d.length;e++)c[d[e]]||(c[d[e]]={}),c=c[d[e]];return c};b.ima3.Flash=function(c){var e,f,g,h,i,j=this,k=document.createElement("div"),l='<param name="flashvars" value="playerId='+j.el().id+"&debug="+j.ima3.settings.debug+'"><param name="wmode" value="transparent"><param name="AllowScriptAccess" value="always">',m=j.el().id+"-ima3-flash",n=function(b){return b&&!/^https?:|file:/.test(b)?a.location.protocol+b:b},o=function(){g.vjs_postrolltimeout()};i=function(a){j.ima3.ready(function(){g.vjs_trigger({type:"adrequest",adTag:j.ima3.adMacroReplacement(n(a)),currentTime:j.currentTime(),options:{}})})},b.ima3.Flash.adrequest=function(){return b.log.warn("videojs.ima3.Flash.adrequest is deprecated. Use player.ima3.adrequest instead."),i.apply(this,arguments)},j.ima3.adrequest=j.ima3.makeAdRequestFunction(i),c.serverUrl=n(c.serverUrl),k.className="vjs-ima3-ad-background",k.innerHTML='<!--[if !IE]>--><object width="100%" height="100%" type="application/x-shockwave-flash" data="'+c.adSwf+'">'+l+"</object><!--<![endif]-->",g=k.querySelector("object"),g||(k.innerHTML='<object width="100%" height="100%" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">  <param name="movie" value="'+c.adSwf+'">'+l+"</object>",g=k.querySelector("object")),g.id=m,g.name=m,g.className="vjs-ima3-ad-container vjs-ima3-flash-ad-container",d(a,"google.ima.ImaSdkSettings").setAutoPlayAdBreaks=function(a){g.vjs_autoplayadbreaks(a)},d(a,"google.ima.AdsManager").getRemainingTime=function(){return g.vjs_getRemainingTime()},d(a,"google.ima.AdsManager").destroy=function(){return g.vjs_destroyAdsManager()},j.el().insertBefore(k,j.el().querySelector(".vjs-control-bar")),f=b.ima3.Flash.adPlayer(g,{contentPlayer:j}),e=new b.ControlBar(f,c.adControlBar),e.addClass("vjs-ad-control-bar"),j.addClass("vjs-ad-controls"),j.addChild(e),j.on("adstart",function(a){j.pause()}),h=a.setInterval(function(){var b=function(a){g.vjs_trigger({type:a.type,options:{serverUrl:j.ima3.adMacroReplacement(j.ima3.settings.serverUrl)}})};g.vjs_trigger&&(j.trigger("ima3-ready"),a.clearInterval(h),j.on("readyforpreroll",b),j.on("contentended",function(a){"postroll?"===j.ads.state&&(j.one("adtimeout",o),a.type="ended",b(a))}),j.on(["contentupdate","dispose"],function(){j.off("adtimeout",o)}),j.on("timeupdate",function(a){g.vjs_trigger({type:a.type,currentTime:j.currentTime()})}),j.on("contentupdate",function(a){var d=j.currentSrc();j.ima3.currentSrc!==d&&(j.ima3.currentSrc=d,"onplay"===c.requestMode?j.one("play",function(){b({type:"contentupdate"})}):"onload"===c.requestMode&&b(a))}),j.ready(function(){var a=j.currentSrc();a&&j.ima3.currentSrc!==a&&(j.ima3.currentSrc=a,"onplay"===c.requestMode?j.one("play",function(){b({type:"contentupdate"})}):"onload"===c.requestMode&&b({type:"contentupdate"}))}),j.on("debug",function(a){g.vjs_trigger({type:a.type,enable:a.enable})}))},50),j.ima3.adControlBar=e,j.ima3.adPlayer=f,j.ima3.el=g,j.ima3.adsManager=google.ima.AdsManager},b.ima3.Flash.adPlayer=function(d,e){var f=new b.ima3.AdPlayer(d,e),g=e.contentPlayer,h=0,i=-1,j=function(a,b){return function(){var c="vjs_"+a;return d[c]?d[c].apply(d,Array.prototype.slice.call(arguments)):b}},k=j("duration"),l=j("currentTime"),m=(j("pause"),j("play"),j("volume",1));return function(){var b,c=!1,d=250,e=function(){c&&(i(),a.setTimeout(e,d))},i=function(){var a=+new Date;h+=a-b,b=a,f.trigger("timeupdate")};f.on("play",function(){g.removeClass("vjs-ima3-paused"),c=!0,b=+new Date,a.setTimeout(e,d)}),f.on("pause",function(){g.addClass("vjs-ima3-paused"),c=!1}),f.on("ima3-started",function(){h=0,b=+new Date})}(),f.currentTime=function(){return Math.min(h/1e3,f.duration())},f.on("durationchange",function(){var a=l(),b=0>a?0:a;i=k(),h=1e3*b}),f.on("ima3-started",function(){g.removeClass("vjs-ima3-paused"),i=k()}),f.on("adserror",function(){g.trigger("adserror")}),f.on("adscanceled",function(){g.trigger("adscanceled")}),f.duration=function(){return 0>i&&(i=k()),i},f.isFullscreen=function(){return g.isFullscreen()},f.requestFullscreen=function(){return g.requestFullscreen()},f.volume=function(a){var b=m();return a===c||a===b?b:(m(a),void f.trigger("volumechange"))},f.pause=j("pause"),f.paused=j("paused"),f.play=j("play"),f}}(window,window.videojs);